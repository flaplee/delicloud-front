'use strict';define(['common/kernel/kernel','site/util/util'],function(a,b){function c(c,d,e,f){f.find('>').remove();var g=new Date().valueOf().toString();b.ajaxSubmit({type:'get',url:'/v1.0/admin/device/my',dauth:c+' '+g+' '+a.buildDauth(c,d,g),data:{org_id:e},success:function success(b){var c=b.data.result;if(0<c.length)for(var d,e=0;e<c.length;e++){d=c[e].binds;for(var g,h=0;h<d.length;h++)if(g=d[h].device,g){var i='<span>'+(g.product&&g.product.name?g.product.name:'')+'</span>',j=$('<tr class="dev-item" data-dev_id="'+d[h].device_id+'">\t\t\t\t\t\t\t\t\t<td class="item-desc">\t\t\t\t\t\t\t\t\t\t<div class="item-img fl">\t\t\t\t\t\t\t\t\t\t\t<img src="'+(g.product.icon?g.product.icon:'')+'" />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="item-text fl">\t\t\t\t\t\t\t\t\t\t\t<p>'+(g.product.name?g.product.name:'')+'</p>\t\t\t\t\t\t\t\t\t\t\t<p>'+g.sn+'</p>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\t\t<td class="item-title">'+g.name+'</td>\t\t\t\t\t\t\t\t\t<td class="item-status">'+(g.product&&'none'==g.product.conn_type?'':'<span class="'+(!0==g.online?'status-online':'status-offline')+'">'+(!0==g.online?'\u5728\u7EBF':'\u79BB\u7EBF')+'</span>')+'</td>\t\t\t\t\t\t\t\t\t<td class="item-app">\t\t\t\t\t\t\t\t\t'+i+'\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\t\t<td class="item-delact">\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="button button-orange btn-dev-rename-item">\u4FEE\u6539\u8BBE\u5907\u540D\u79F0</a>\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="button button-red btn-dev-delete-item">\u5220\u9664\u8BBE\u5907</a>\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="button btn-dev-bind-item hide">\u7ED1\u5B9A\u5176\u4ED6\u5E94\u7528</a>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\t</tr>');f.append(j),function setOperates(b,c){b.find('.btn-dev-rename-item').off('click').on('click',function(){a.openPopup('editdevice',{type:'editdevice',data:c})}),b.find('.btn-dev-delete-item').off('click').on('click',function(){a.openPopup('deldevice',{type:'deldevice',data:c})})}(j,{orgid:d[h].org_id,devid:d[h].device_id,name:g.name})}}else{f.append($('<tr class="empty empty-device"><td colspan="5" class="empty-item"><div class="empty-img empty-img-device"></div><p class="empty-text">\u6682\u65E0\u8BBE\u5907</p></td></tr>'))}}})}var d,e,f,g,h,i,j,k=$('#device .dev-box'),l=k.find('.dev-main .dev-installed .dev-wrap table.table tbody.tbody');return{onload:function onload(){if(d=b.getCookie('userid'),e=b.getCookie('token'),f=b.getCookie('orgid'),g=b.getCookie('orgname'),h=b.getCookie('parentid'),i=b.clone(a.location),j=i.id,void 0===d||void 0===e||void 0===f)b.setUserData(void 0),a.replaceLocation({args:{},id:'loginhome'});else{if('device'==j){var k=$('#header .user-head .nav-top .nav-item');k.find('a.navlink').removeClass('navlink-current'),k.find('a.navlink-group').show(),k.find('a.navlink-user').hide(),k.find('a.navlink-admin').hide(),k.find('a.navlink.devBtn').addClass('navlink-current')}c(d,e,f,l)}},getDeviceSub:function getDeviceSub(a,b,d,e){c(a,b,d,e)}}});