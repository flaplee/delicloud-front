'use strict';define(['common/kernel/kernel','site/util/util','common/text/text!page/imports/member.html!strip'],function(a,b,c){function d(c){var d=new Date().valueOf().toString();b.ajaxSubmit({type:'get',url:c.url,dauth:c.userid+' '+d+' '+a.buildDauth(c.userid,c.token,d),data:{task_id:c.task_id,status:c.status,size:c.size,page:c.page},success:function success(b){if(1==c.status&&0==c.page?c.$target.find('.imports-table-enable table.table tbody.tbody >').remove():-1==c.status&&0==c.page&&c.$target.find('.imports-table-unable table.table tbody.tbody >').remove(),0==b.code){var d=b.data.result,e='';1==c.status?c.$target.find('span.nav-enable-num').text(d.total):c.$target.find('span.nav-unable-num').text(d.total),0<=d.total&&d.rows&&0<d.rows.length?($.each(d.rows,function(a,b){e+='<tr>                                <td class="user-index">'+(c.page*c.size+a+1)+'</td>                                <td class="user-name"><p>'+b.name+'</p></td>                                <td class="user-employeenum">'+b.employee_num+'</td>                                <td class="user-deptname" title="'+b.dept_name+'"><p>'+b.dept_name+'</p></td>                                <td class="user-title" title="'+b.title+'"><p>'+b.title+'</p></td>                                <td class="user-mobile">'+b.mobile+'</td>                                '+(c.status&&1!=c.status?'<td class="user-error"><span class="red">'+(b.msg&&''!=b.msg?b.msg:'\u901A\u8BAF\u5F55\u4E2D\u5DF2\u5B58\u5728\u8BE5\u624B\u673A\u53F7\u7801\u7684\u5458\u5DE5')+'</span></td>':'')+'                            </tr>'}),1==c.status?c.$target.find('.imports-table-enable .table-data-wrap .table-data tbody.tbody').append(e):c.$target.find('.imports-table-unable .table-data-wrap .table-data tbody.tbody').append(e),d.rows.length>=k?1==c.status?l=!0:n=!0:1==c.status&&0<j?0==c.$target.find('.imports-table-enable .table-data-wrap .table-data tbody.tbody tr').length&&c.$target.find('.imports-table-enable .table-data-wrap .table-data tbody.tbody').append('<tr class="empty"><td rowspan="3" colspan="5">\u6CA1\u6709\u66F4\u591A\u4E86</td></tr>'):1==c.status&&0<m&&0==c.$target.find('.imports-table-unable .table-data-wrap .table-data tbody.tbody tr').length&&c.$target.find('.imports-table-unable .table-data-wrap .table-data tbody.tbody').append('<tr class="empty"><td rowspan="3" colspan="6">\u6CA1\u6709\u66F4\u591A\u4E86</td></tr>')):1==c.status?0==c.$target.find('.imports-table-enable .table-data-wrap .table-data tbody.tbody tr').length&&c.$target.find('.imports-table-enable .table-data-wrap .table-data tbody.tbody').append('<tr class="empty"><td rowspan="3" colspan="5">\u6682\u65E0\u5DF2\u5BFC\u5165\u6570\u636E</td></tr>'):0==c.$target.find('.imports-table-unable .table-data-wrap .table-data tbody.tbody tr').length&&c.$target.find('.imports-table-unable .table-data-wrap .table-data tbody.tbody').append('<tr class="empty"><td rowspan="3" colspan="6">\u6682\u65E0\u4E0D\u53EF\u5BFC\u5165\u6570\u636E</td></tr>')}else a.hint('\u67E5\u770B\u5386\u53F2\u5BFC\u5165\u4EFB\u52A1\u5931\u8D25','error')}})}var f=a.parseHash(location.hash).args.id,g=b.getCookie('userid'),h=b.getCookie('token'),i=b.getCookie('orgid'),j=0,k=50,l=!1,m=0,n=!1,e=$(c),o=$('#imports .imports-box'),p=o.find('.imports-info .imports-inner');p.append(e);var q=p.find('.imports-inner-data .imports-nav a'),r=p.find('.imports-inner-data .imports-table'),s=p.find('.imports-upload button.btn-upload');return q.on('click',function(b){b.stopPropagation();var d=a.parseHash(location.hash),e=d.args.id,f=$(this),c=f.index();f.hasClass('active')||(f.addClass('active').siblings().removeClass('active'),r.find('>div').eq(c).addClass('active').siblings().removeClass('active'),r.find('>div').eq(c).find('.table-data-wrap').addClass('active'),r.find('>div').eq(c).siblings().find('.table-data-wrap').removeClass('active'),d.args.imports=0==c?'enable':'unable',a.replaceLocation(d))}),s.on('click',function(b){b.stopPropagation();var c=a.parseHash(location.hash);c={id:'imports',args:{}},a.replaceLocation(c)}),f&&(d({status:1,task_id:f,userid:g,token:h,url:'/v1.0/importtask/item/byTask',orgid:i,page:j,size:k,$target:p.find('.imports-inner-data')}),d({status:-1,task_id:f,userid:g,token:h,url:'/v1.0/importtask/item/byTask',orgid:i,page:m,size:k,$target:p.find('.imports-inner-data')}),p.find('.imports-inner-data .imports-table .imports-table-enable .table-data-wrap').off('scroll').scroll(function(){var a=$(this).height(),b=$(this)[0].scrollHeight;$(this)[0].scrollTop+a+150>=b&&0!=$(this)[0].scrollTop&&l&&(l=!1,d({status:1,task_id:f,userid:g,token:h,url:'/v1.0/importtask/item/byTask',orgid:i,page:++j,size:k,$target:p.find('.imports-inner-data')}))}),p.find('.imports-inner-data .imports-table .imports-table-unable .table-data-wrap').off('scroll').scroll(function(){var a=$(this).height(),b=$(this)[0].scrollHeight;$(this)[0].scrollTop+a+150>=b&&0!=$(this)[0].scrollTop&&n&&(n=!1,d({status:-1,task_id:f,userid:g,token:h,url:'/v1.0/importtask/item/byTask',orgid:i,page:++m,size:k,$target:p.find('.imports-inner-data')}))})),function(){}});