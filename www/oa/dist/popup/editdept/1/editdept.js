'use strict';define(['module','common/kernel/kernel','site/util/util','page/contacts/contacts'],function(a,b,c,d){var e,f,g,h,i,j,k,l,m=c.getCookie('userid'),n=c.getCookie('token'),o=c.getCookie('orgid'),p=c.getCookie('parentid'),q=a.id.replace(/^[^/]+\/|\/[^/]+/g,''),r=$('#'+q),s=r.find('.form-group p.form-text'),t=r.find('.form-group .form-name input.deptname'),u=r.find('.btn-confirm'),v=r.find('.btn-close');return{onload:function onload(a){console.log('params',a);var o=a.data;h=a.type,e=o.id,f=o.pid,g=o.text,i=o.name,j=a.func,k=a.$target,l=a.isNeedLoad,t.attr('data-id',e),t.val(i),s.text(g),u.off('click').on('click',function(){if('rename'==h||'edit'==h){var a='\u90E8\u95E8\u91CD\u547D\u540D\u6210\u529F~';c.ajaxSubmit({type:'post',url:'/v1.0/org/department/'+t.attr('data-id')+'/name',dauth:m+' '+new Date().valueOf()+' '+b.buildDauth(m,n,new Date().valueOf()),data:{name:t.val()},success:function success(c){console.log('res',c),c&&0==c.code?(b.closePopup('editdept'),b.hint(a,3e3),k.text(t.val())):b.hint(c.msg,3e3)},error:function error(a){b.hint(a.msg,3e3),b.closePopup('editdept')}})}else if('add'==h){var a='\u6DFB\u52A0\u90E8\u95E8\u6210\u529F~';c.ajaxSubmit({type:'post',url:'/v1.0/org/department',dauth:m+' '+new Date().valueOf()+' '+b.buildDauth(m,n,new Date().valueOf()),data:{org_id:f,name:t.val(),parent_id:e},success:function success(c){c&&0==c.code?(b.closePopup('editdept'),b.hint(a,3e3),j&&'function'==typeof j&&j(),l&&!0==l&&d.initDepartment($('#contacts .contacts-menu .contacts-list .contacts-team .dept-select-list ul.dept-select-inner'),{status:'onload',type:'parent',parentid:e,orgid:f},!0)):b.hint(c.msg,3e3)},error:function error(a){b.hint(a.msg,3e3),b.closePopup('editdept')}})}}),v.off('click').on('click',function(){b.closePopup('editdept')})}}});