!function(e){var t,i,o=["common.supbrowser","app.getLoginStatus","app.onlogout","web.getLoginStatus","web.onlogout","web.onrequest","web.getNextInfo","web.getCurrentInfo","web.getUsersFromOrg"],a="1.0.3",n=!1,r=null,d=null,l=null,s="202",c="www"==s?"https://www.delicloud.com":"test"==s?"http://t.delicloud.com":"202"==s?"http://192.168.0.202":"http://192.168.0.201",p="www"==s?"https://www.delicloud.com/web":"test"==s?"http://t.delicloud.com/web":"202"==s?"http://192.168.0.202:9002":"http://192.168.0.201:9002";!function(){function t(e,t,i){return e+=-1==e.indexOf("?")?"?":"&",e+=encodeURIComponent(t)+"="+encodeURIComponent(i)}var i=function(e){this.config={url:"",type:"get",async:!0,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{}},this.start(e)},o=null;i.init=function(e){new i(e)},i.prototype={constructor:i,createXHR:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject){if("string"!=typeof arguments.callee.activeXString){var e,t,i=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"];for(e=0,t=i.length;e<t;e++)try{new ActiveXObject(i[e]),arguments.callee.activeXString=i[e];break}catch(o){}}return new ActiveXObject(arguments.callee.activeXString)}throw Error("No XHR object available.")},start:function(i){var a,n,r,d,l;if(o=new this.createXHR,!i.url)throw Error("url cannot be null!");if(this.config.url=i.url,i.type&&(this.config.type=i.type),i.async&&(this.config.async=i.async),i.dataType&&(this.config.dataType=i.dataType),i.data&&(this.config.data=i.data),i.success&&(this.config.success=i.success),i.fail&&(this.config.fail=i.fail),i.beforeSend&&i.beforeSend(),a=function(){if(4==o.readyState)if(o.status>=200&&o.status<300||304==o.status)i.success&&i.success(o.responseText);else{if(!i.fail)throw Error("Request was unsucessful:"+o.status);i.fail()}},"json"==this.config.dataType||"JSON"==this.config.dataType){if("GET"==this.config.type||"get"==this.config.type){for(n in this.config.data)this.config.url=t(this.config.url,n,this.config.data[n]);o.onreadystatechange=a,o.open(this.config.type,this.config.url,this.config.async),o.send(null)}"POST"!=this.config.type&&"post"!=this.config.type||(o.addEventListener("readystatechange",a),o.open(this.config.type,this.config.url,this.config.async),i.contentType&&(this.config.contentType=i.contentType),o.setRequestHeader("Content-Type",this.config.contentType),o.send(function(e){var t,i="";for(t in e)i+=t+"="+e[t]+"&";return i.slice(0,i.length-1)}(this.config.data)))}else{if("jsonp"!=this.config.dataType&&"JSONP"!=this.config.dataType)throw Error("dataType is error!");if("GET"==this.config.type||"get"==this.config.type){if(!i.url||!i.callback)throw Error("params is illegal!");this.config.callback=i.callback,r="callback",d=document.getElementsByTagName("head")[0],this.config[this.config.callback]=r,l=document.createElement("script"),d.appendChild(l),e[r]=function(t){d.removeChild(l),clearTimeout(l.timer),e[r]=null,i.success&&i.success(t)},i.time&&(l.timer=setTimeout(function(){d.removeChild(l),i.fail&&i.fail({message:"over time"}),e[r]=null},i.time)),this.config.url=this.config.url+"?callback="+r;for(n in this.config.data)this.config.url=t(this.config.url,n,this.config.data[n]);l.src=this.config.url}}}},e.deliApi=i}(),t={version:a,init:function(t,i){var o=this;!1===n&&(n=!0,null!==r&&r.sign?deliApi.init({url:c+"/web/v1.0/cd/premission/check/public",type:"get",dataType:"jsonp",data:r,callback:"callback",success:function(t){if(0==t.code)o.util.getQuery("user_id")===undefined&&"undefined"==o.util.getCookie("app_user_id")&&o.util.getQuery("token")===undefined&&"undefined"==o.util.getCookie("app_token")?(alert("用户未登录或者登录信息已经过期，请重新登录"),e.location.replace(c+"/oa/")):setTimeout(function(){o.prefixLoadTpl(o.util.getQuery("user_id")||o.util.getCookie("app_user_id"),o.util.getQuery("token")||o.util.getCookie("app_token")),"function"==typeof i&&i()},0);else{var a=t.msg?t.msg:"网络或服务器错误",n=t.msg?"-1":"-3";setTimeout(function(){d&&d({message:"权限校验失败 "+a,errorCode:n})})}},fail:function(e){var t=e.msg?e.msg:"网络或服务器错误",i=e.msg?"-1":"-3";setTimeout(function(){d&&d({message:"权限校验失败 "+t,errorCode:i})})}}):console.log("配置错误，请重新填写配置",r))},config:function(e){e&&(r={appId:e.appId||-1,timestamp:e.timestamp,noncestr:e.noncestr,sign:e.signature},e.appId&&(r.appId=e.appId))},api:function(t){var i,o,a=new XMLHttpRequest,n=t.type||"post",r=t.url;if("get"===n&&t.data){i=[];for(o in t.data)t.data.hasOwnProperty(o)&&i.push(o+"="+t.data[o]);r=r+"?"+i.join("&")}a.open(n,r,!0),t.data||(t.data={}),a.onreadystatechange=function(){var i;if(4===a.readyState){if(200===a.status){try{i=JSON.parse(a.responseText)}catch(o){}i?0==i.code?"function"==typeof t.success&&t.success(i):("function"==typeof t.error?t.error(i):t.silent||alert(i.msg),9102112==i.code&&(alert(i.msg),e.location.replace(c+"/oa/"))):"function"==typeof t.error?t.error(a,"parse_error"):t.silent||alert("数据解析失败: "+a.responseText)}else"function"==typeof t.error?t.error(a,"network_error"):t.silent||alert("网络或服务器错误: "+a.status);"function"==typeof t.complete&&t.complete(a)}},t.data instanceof FormData?(t.dauth&&(a.setRequestHeader("Dauth",t.dauth),a.setRequestHeader("Duagent","_web")),a.send(t.data)):(a.setRequestHeader("content-type","application/json"),t.dauth&&(a.setRequestHeader("Dauth",t.dauth),a.setRequestHeader("Duagent","_web")),a.send(JSON.stringify(t.data)))},apiJsonp:function(t){var i,o,a,n;if(!(t=t||{}).url||!t.callback)throw Error("参数不合法");i=("jsonp_"+Math.random()).replace(".",""),o=document.getElementsByTagName("head")[0],t.data[t.callback]=i,a=function(e){var t,i=[];for(t in e)i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return i.join("&")}(t.data),n=document.createElement("script"),o.appendChild(n),e[i]=function(a){o.removeChild(n),clearTimeout(n.timer),e[i]=null,t.success&&t.success(a)},n.src=t.url+"?"+a,t.time&&(n.timer=setTimeout(function(){e[i]=null,o.removeChild(n),t.fail&&t.fail({message:"超时"})},time))},error:function(e){d=e},ready:function(e){var t=this,i=function(i){t.init(r,e)};i()},prefixLoadTpl:function(t,i){var o=this,a=function(){var a,n,r,d,l,s='<style>body,button,dd,div,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,input,legend,li,ol,p,td,textarea,th,ul{margin:0;padding:0}                        i{font-style:normal}                        ul{list-style:none}                        table{border-collapse:collapse;border-spacing:0}                        body{font-size:12px;font-family:Microsoft YaHei UI,"微软雅黑",Heiti SC,Droid Sans;color:#666;background-color:#fff}                        .deli-wrap-header{position: fixed; z-index: 100; clear: both; height: 80px; background: #fff; font-size: 12px;box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -moz-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -webkit-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -o-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5);filter: progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4);-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4)";}                        .deli-wrap-header a{color:#666;text-decoration:none;hide-focus:expression(this.hideFocus=true);outline:0}                        .deli-wrap-header a:hover{text-decoration:none}                        .deli-wrap-header a img{border:none}                        .deli-wrap-header .pointer{cursor:pointer}                        .deli-wrap-header{width:100%;height:80px;background-color:#FDFDFD;box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -moz-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -webkit-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -o-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5);filter: progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4);-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4)";}                        .deli-wrap-deli-footer{background-color:#cfd2d7;margin:0 auto}                        .deli-wrap-header.deli-wrap-top{background:#fff}                        .deli-wrap-header.deli-wrap-top.deli-wrap-top-shadow{box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -moz-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -webkit-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5); -o-box-shadow: 0 1px 10px 0 rgba(3, 18, 18, 0.5);filter: progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4);-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4)";}                        .deli-wrap-header .deli-user-head{width:100%;height:80px;margin:0 auto;background-color:#fff}                        .deli-clear:after{visibility:hidden;display:block;font-size:0;content:"";clear:both;height:0}                        .deli-clear{zoom:1}                        .deli-clearfix:after,deli-clearfix:before{content:" ";display:table}.deli-clearfix:after{clear:both}                        .deli-wrap-header .user-float{background-color:#fff;position:fixed;width:100%;min-width:1200px;margin:auto;top:0;left:0;z-index:3;box-shadow:0 2px 5px rgba(0,0,0,.2);-moz-box-shadow:0 2px 5px rgba(0,0,0,.2);-webkit-box-shadow:0 2px 5px rgba(0,0,0,.2);-o-box-shadow:0 2px 5px rgba(0,0,0,.2);filter: progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4);-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Direction=125, Strength=4)";}                        .deli-wrap-header #deli-head{width: 1200px;height:100%;z-index:1;position:relative;z-index:100;clear:both;height:80px;background:#fff;font-size:12px;margin: 0 auto;}                        .deli-wrap-header #deli-head .deli-logo-box{display: inline-block; position: absolute; bottom: 0; left: 0;}                        .deli-wrap-header #deli-head .deli-logo-box .deli-logo{display: inline-block; float: left; width: 178px; height: 50px; line-height: 50px; margin: 15px 0;background-image: url(https://static.delicloud.com/www/home/images/logo.png?v=20180317); background-repeat: no-repeat; background-size: cover;}                        .deli-wrap-header #deli-head .deli-nav-top{width: 900px; height: 40px; position: absolute; bottom: 20px; right: 20px;}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item{display:inline-block;-width:85px;height:40px;line-height:40px;margin-left:25px;float:left;position:relative}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item.deli-nav-item-team{display:none}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink{display:inline-block;width:85px;height:40px;line-height:40px;text-align:center;font-size:16px;color:#666;text-decoration:none;position:relative;border-radius:5px}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink.deli-nav-item-current{width:120px;padding:0 10px;color:#5d85e0;border:1px solid #5d85e0;border-radius:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink.deli-nav-item-current.larget{width:140px;padding:0 20px}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink.deli-nav-item-current .deli-navlink-icon{font-size:12px;color:#5d85e0;position:absolute;right:10px}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink:hover{-background-color:#55BEBF;color:#5d85e0}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item a.deli-navlink-current{-background-color:#55BEBF;color:#5d85e0}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item .son-nav-list{width:150px;position:absolute;z-index:1;background-color:#fff;top:60px;display:none;left:-15px;border:1px solid #d9d9d9;border-top:0}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item .son-nav-list a.sub-deli-nav-item{display:block;width:150px;padding:0 10px;height:40px;line-height:40px;font-size:14px;text-align:center;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item .son-nav-list a.sub-deli-nav-item.current,.deli-wrap-header #deli-head .deli-nav-top .deli-nav-item .son-nav-list a.sub-deli-nav-item:hover{color:#5d85e0}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item.deli-nav-item-login{position: absolute; right: 0; text-align: center;}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nav-item.deli-nav-item-device{margin-left: 0;}                        deli-wrap-header #deli-head .deli-nav-top .deli-nologin{display:block;font-size:16px;margin-left:5px;width:100px}                        .deli-wrap-header #deli-head .deli-nav-top .deli-nologin a{font-size:16px;color:#5d85e0;text-decoration:none}                        .deli-wrap-header #deli-head .deli-nav-top .userBtn.hasLogin:hover{position:relative}                        .deli-wrap-header #deli-head .deli-nav-top .userBtn.hasLogin:hover>.deli-user-panel{display:block}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel{display:none;position:relative;top:-20px;right:0;background-color:#fff;z-index:1;width:80px;height:80px;overflow:visible}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-info{position:relative;display:inline-block;width:80px;height:50px;overflow:hidden;margin:15px auto}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-info .deli-user-info-avatar{width:50px;height:50px;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;-o-border-radius:50%;display:inline-block}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-info i{display:none;position:absolute;top:8px;right:8px}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-info.visited i,.deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-info:hover i{display:block}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-asset{display:none;border:1px solid #d9d9d9;border-top:0}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-asset .deli-user-asset-link{display:inline-block;width:80px;height:40px;line-height:40px;text-align:center;font-size:14px;color:#666;background-color:#fff}                        .deli-wrap-header #deli-head .deli-nav-top .deli-user-panel .deli-user-asset .deli-user-asset-link:hover{color:#5d85e0}                        .deli-wrap-footer{background-color:#cfd2d7}                        .deli-footer{-padding-top:25px;padding-top:50px; width:1200px;margin:0 auto}                        .deli-footer-link{-height:100px;width: 95%; padding-left: 5%;}                        .deli-footer-link dl{-width:155px; width:275px; float:left;-height:100px;-margin-right:100px;margin-bottom:0}                        .deli-footer-link dl.deli-attus{position:relative;-width:170px;width:220px;margin-right:0}                        .deli-footer-link dl.deli-attus .deli-icon-phone{display:inline-block; background:url(https://static.delicloud.com/www/home/images/telephone_icon.png) 0 0 no-repeat;width:16px;height:18px; vertical-align: top; margin-top: 3px; margin-right: 10px;}                        .deli-footer-link dl.deli-attus .deli-icon-weixin-img{-display:none; display:inline-block; -position:absolute;-top:-80px;-left:-25px;-background-image:url(https://static.delicloud.com/www/home/images/weixin.png); background-image:url(https://static.delicloud.com/www/home/images/wechat_icon.png);-width:80px;width:22px;-height:80px; height:18px; vertical-align: top; margin-top: 3px; margin-right: 6px;}                        .deli-footer-link dl.deli-attus .deli-icon-qq{-margin-right:50px;display: inline-block; background-image:url(https://static.delicloud.com/www/home/images/qq_icon.png); width: 16px;height: 18px; vertical-align: top; margin-top: 3px; margin-right: 10px;}                        .deli-footer-link dl.deli-attus .deli-icon-weixin{position:relative}                        .deli-footer-link dl.deli-attus .deli-icon-qq,.deli-footer-link dl.deli-attus .deli-icon-weixin{font-size:30px;color:#333;cursor:pointer;text-decoration:none}                        .deli-footer-link dl.deli-attus .deli-icon-qq:hover,.deli-footer-link dl.deli-attus .deli-icon-weixin:hover{color:#55bfbe}                        .deli-footer-link dl.deli-attus .deli-icon-weixin:hover .deli-icon-weixin-img{display:block}                        .deli-footer-link dl .deli-kefu-phone{font-size:16px}                        .deli-footer-link dl dt{font-size:18px; font-weight:700; -line-height:26px; color:#666; letter-spacing:5px;margin-bottom:20px;}                        .deli-footer-link dl dd{line-height:24px;font-size:14px;color:#959799;margin-bottom:18px;letter-spacing:5px}                        .deli-footer-link dl dd a{font-size:16px;color:#333;letter-spacing:2px;display:inline-block;text-decoration:none}                        .deli-footer-link dl dd:hover a{color:#666;text-decoration:none}                        .deli-footer-copyright{font-size:14px;color:#666;height:50px;padding-top:20px;text-align:center;letter-spacing:2px;}                        .deli-footer-link dl.deli-attus dd b {font-size: 16px; color: #333; font-weight: normal;letter-spacing:2px; cursor: pointer;}                        .deli-footer-link dl.deli-attus dd:hover b {color: #666;}</style>',p=document.head||document.getElementsByTagName("head")[0],u=document.createElement("style");u.type="text/css",u.styleSheet?u.styleSheet.cssText=s:u.appendChild(document.createTextNode(s)),p.appendChild(u),a='<div class="deli-user-head">                        <div id="deli-head" class="deli-clear">                            <div class="deli-logo-box">                                <a href="http://pretest.deli" class="deli-logo" title="得力e+"></a>                            </div>                            <div class="deli-nav-top">                                <ul class="deli-nav-top-list deli-clear">                                    <li class="deli-nav-item"><a href="http://pretest.deli/oa/" class="deli-navlink">首页</a>                                    </li>                                    <li class="deli-nav-item"><a href="http://pretest.deli/oa/#!contacts" class="deli-navlink">组织通讯录</a>                                    </li>                                    <li class="deli-nav-item"><a href="http://pretest.deli/oa/#!apphome" class="deli-navlink">应用</a>                                    </li>                                    <li class="deli-nav-item deli-nav-item-device"><a href="http://pretest.deli/oa/#!device" class="deli-navlink">设备</a>                                    </li>                                    <li class="deli-nav-item deli-nav-item-team"><a href="javascript:;" class="deli-navlink deli-nav-item-current"><span class="deli-navlink-name"></span> <span class="deli-navlink-icon"><i class="iconfont">&#xe608;</i></span></a>                                        <div class="sun-nav-list sun-nav-list-team">                                            <a class="sub-deli-nav-item current" href="javascript:;"></a>                                            <a class="sub-deli-nav-item" href="javascript:;"></a>                                            <a class="sub-deli-nav-item" href="javascript:;"></a>                                        </div>                                    </li>                                    <li class="deli-nav-item deli-nav-item-login">                                        <div class="deli-nologin"><a href="javascript:;" class="deli-nologin-btn">退出</a></div>                                        <div class="deli-login deli-user-panel">                                            <a href="javascript:;" class="deli-user-info fl" style="display:block">                                                <img class="deli-user-info-avatar" width="50" height="50" src=""><i class="iconfont"></i>                                            </a>                                            <div class="deli-user-asset fl" style="display:none"><a class="deli-user-asset-link deli-logout" href="javascript:;">退出登录</a>                                            </div>                                        </div>                                    </li>                                </ul>                            </div>                        </div>                    </div>',n='<div class="deli-footer">                        <div class="deli-footer-link deli-clear">                            <dl><dt>使用帮助</dt>                                <dd><a href="http://b2b.nbdeli.com" target="_blank">去购买智能设备</a>                                </dd>                                <dd><a href="http://download.delicloud.com/app/delispecification.pdf" target="_blank">App使用帮助</a>                                </dd>                            </dl>                            <dl><dt>应用开发商</dt>                                <dd><a href="http://doc.delicloud.com/site/" target="_blank">应用接入指南</a>                                </dd>                            </dl>                            <dl><dt>关于我们</dt>                                <dd><a href="http://www.nbdeli.com/" target="_blank">关于得力</a>                                </dd>                                <dd><a href="http://hr.nbdeli.cn/scripts/mgrqispi.dll?Appname=HRsoft2000&Prgname=REC2_RESUME_STAFF_P&ARGUMENTS=-AC" target="_blank">加入我们</a>                                </dd>                            </dl>                            <dl class="deli-attus"><dt>联系我们</dt>                                <dd class="deli-kefu-phone"><span class="deli-icon-phone"></span><b>400-185-0555</b></dd>                                <dd class="deli-kefu-qq"><span class="deli-icon-qq"></span><b>327264079</b></dd>                                <dd class="deli-kefu-wechat"><span class="deli-icon-weixin-img"></span><b>得力e+公众号</b></dd>                            </dl>                        </div>                        <div class="deli-footer-copyright">鄂ICP备17027057号  Copyright &copy;2018 武汉得力智能办公研究院有限公司 版权所有</div>                    </div>',r=document.createElement("div"),d=document.createElement("div"),r.className="deli-wrap-header",d.className="deli-wrap-footer",r.innerHTML=a,d.innerHTML=n,document.querySelector("body").appendChild(d),document.querySelector("body").insertBefore(r,document.body.firstElementChild||document.body.children[0]),(l=document.querySelector(".deli-wrap-header .deli-nologin a.deli-nologin-btn")).addEventListener?l.addEventListener("click",function(){o.util.setCookie("app_user_id",undefined),o.util.setCookie("app_org_id",undefined),o.util.setCookie("app_token",undefined),o.logout(t,i,function(){e.location.replace(c+"/oa/")})},!1):l.attachEvent("onclick",function(){o.util.setCookie("app_user_id",undefined),o.util.setCookie("app_org_id",undefined),o.util.setCookie("app_token",undefined),o.logout(t,i,function(){e.location.replace(c+"/oa/")})})};t&&i?deliApi.init({url:c+"/web/v1.0/cd/login/"+t+"/web",type:"get",dataType:"jsonp",data:{},callback:"callback",success:function(e){if(0==e.code){"connect"==(e.data.result.token&&e.data.result.token.length>0?"connect":"noconnect")?(o.util.setCookie("app_org_id",o.util.getQuery("org_id")),o.util.setCookie("app_user_id",e.data.result.user_id),o.util.setCookie("app_token",e.data.result.token)):o.logout(t,i),a()}},fail:function(n){if(0==n.code){"connect"==(n.data.result.token&&n.data.result.token.length>0?"connect":"noconnect")||o.logout(t,i),a()}else 9102112==n.code?setTimeout(function(){d&&d({message:n.msg,errorCode:-1})}):(alert("用户未登录或者登录信息已经过期，请重新登录"),e.location.replace(c+"/oa/"))}}):(alert("用户未登录或者登录信息已经过期，请重新登录"),e.location.replace(c+"/oa/"))},logout:function(e,t,i){var o=this,a=(new Date).valueOf();deliApi.init({url:c+"/web/v1.0/cd/logout/web",type:"get",dataType:"jsonp",data:{Dauth:e+" "+a+" "+o.util.buildDauth(e,t,a),Duagent:"_web"},callback:"callback",success:function(e){0==e.code?(o.util.setCookie("app_user_id",undefined),o.util.setCookie("app_org_id",undefined),o.util.setCookie("app_token",undefined),l&&l({data:e.data}),"function"==typeof i&&i()):"function"==typeof i&&i()},fail:function(e){"function"==typeof i&&i(),setTimeout(function(){d&&d({message:e.msg,errorCode:-1})})}})},util:{setCookie:function(e,t,i){var o,a=new Date;a.setDate(a.getDate()+i),o=escape(t)+"; path=/"+(null==i?"":"; expires="+a.toUTCString()),document.cookie=e+"="+o},getCookie:function(e){var t,i,o,a=document.cookie.split(";");for(t=0;t<a.length;t++)if(i=a[t].substr(0,a[t].indexOf("=")),o=a[t].substr(a[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==e)return unescape(o)},buildHash:function(e){var t,i;for(t in e.args)i+=e.args[t]===undefined?"&"+encodeURIComponent(t):"&"+encodeURIComponent(t)+"="+encodeURIComponent(e.args[t]);return i},parseHash:function(e){var t,i,o,a={args:{}};if(e=e.substr(1).replace(/[#\?].*$/,""),o=e.match(/[^=&]+(=[^&]*)?/g)){"!"===o[0].charAt(0)&&(i=o[0].substr(1))in pages&&(a.id=decodeURIComponent(i));for(t=1;t<o.length;t++)(i=o[t].match(/^([^=]+)(=)?(.+)?$/))&&(a.args[decodeURIComponent(i[1])]=i[2]?decodeURIComponent(i[3]||""):undefined)}return a},getQuery:function(t){var i,o,a,n,r;for(Function.prototype.method=function(e,t){return this.prototype[e]=t,this},String.prototype.trim||(String.method("trim",function(){return this.replace(/^\s+|\s+$/g,"")}),String.method("ltrim",function(){return this.replace(/^\s+/g,"")}),String.method("rtrim",function(){return this.replace(/\s+$/g,"")})),o=(i=e.location.href).indexOf("?"),a=i.slice(o+1).split("&"),n=0;n<a.length;n++)if((r=a[n].split("="))[0].trim()==t)return r[1].trim()},SHA256:function(e){function t(e,t){var i=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(i>>16);return o<<16|65535&i}function i(e,t){return e>>>t|e<<32-t}function o(e,t){return e>>>t}function a(e,t,i){return e&t^~e&i}function n(e,t,i){return e&t^e&i^t&i}function r(e){return i(e,2)^i(e,13)^i(e,22)}function d(e){return i(e,6)^i(e,11)^i(e,25)}function l(e){return i(e,7)^i(e,18)^o(e,3)}function s(e){return i(e,17)^i(e,19)^o(e,10)}var c=8,p=0;return e=function(e){var t,i,o;for(e=e.replace(/\r\n/g,"\n"),t="",i=0;i<e.length;i++)(o=e.charCodeAt(i))<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128));return t}(e),function(e){var t,i=p?"0123456789ABCDEF":"0123456789abcdef",o="";for(t=0;t<4*e.length;t++)o+=i.charAt(e[t>>2]>>8*(3-t%4)+4&15)+i.charAt(e[t>>2]>>8*(3-t%4)&15);return o}(function(e,i){var o,c,p,u,h,f,g,m,w,b,v,x,k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],C=Array(64);for(e[i>>5]|=128<<24-i%32,e[15+(i+64>>9<<4)]=i,w=0;w<e.length;w+=16){for(o=y[0],c=y[1],p=y[2],u=y[3],h=y[4],f=y[5],g=y[6],m=y[7],b=0;b<64;b++)C[b]=b<16?e[b+w]:t(t(t(s(C[b-2]),C[b-7]),l(C[b-15])),C[b-16]),v=t(t(t(t(m,d(h)),a(h,f,g)),k[b]),C[b]),x=t(r(o),n(o,c,p)),m=g,g=f,f=h,h=t(u,v),u=p,p=c,c=o,o=t(v,x);y[0]=t(o,y[0]),y[1]=t(c,y[1]),y[2]=t(p,y[2]),y[3]=t(u,y[3]),y[4]=t(h,y[4]),y[5]=t(f,y[5]),y[6]=t(g,y[6]),y[7]=t(m,y[7])}return y}(function(e){var t,i=[],o=(1<<c)-1;for(t=0;t<e.length*c;t+=c)i[t>>5]|=(e.charCodeAt(t/c)&o)<<24-t%32;return i}(e),e.length*c))},buildDauth:function(e,i,o){var a=(e||"")+(i||"")+o,n=t.util.SHA256(a),r=n.substr(0,32);return r}}},i=function(e,i){var o,a,n=e.split("."),r=t;for(o=0,a=n.length;o<a;o++)o===a-1&&(r[n[o]]=i),"undefined"==typeof r[n[o]]&&(r[n[o]]={}),r=r[n[o]]},Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i,o,a,n,r;if(null==this)throw new TypeError("this is null or not defined");if(a=Object(this),n=a.length>>>0,"function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(i=t),o=0;o<n;)o in a&&(r=a[o],e.call(i,r,o,a)),o++}),o.forEach(function(o){i(o,function(i,a,n){!function(i,o,a,n){function r(e,t){var i,o,a,n;if(e.getElementsByClassName)return e.getElementsByClassName(t);for(i=[],a=0,n=(o=e.getElementsByTagName("*")).length;a<n;a++)-1!=o[a].className.indexOf(t)&&(i[i.length]=o[a]);return i}var l,s,c,u,h,f,g,m=o||{},w=function(e){},b=function(e){};switch(a&&(w=a),n&&(b=n),l=function(e){var t=e||{},o=t.code,a=t.result;if("0"===o){switch(i){case"common.supbrowser":case"app.onlogout":case"web.onlogout":case"web.onrequest":case"web.getNextInfo":case"web.getCurrentInfo":case"web.getUsersFromOrg":a=t.result}w&&w.call(null,a)}else b&&b.call(null,a,o)},i){case"common.supbrowser":m&&m.ie?((m.ie<=8&&!("WebSocket"in e&&2===e.WebSocket.CLOSING)||m.ie>=9)&&(s=function(){var e=r(document,"deli-wrap-header")[0];void 0===e?setTimeout(s,10):e.insertBefore(u,e.firstChild)},(c=r(document,"deli-wrap-supbrowser")[0])&&"undefined"!=c||((u=document.createElement("div")).className="deli-wrap-supbrowser",u.style.width="100%",u.style.height="40px",u.style.backgroundColor="#f8f4ce",u.innerHTML='<div style="width: 1200px;height: 40px;line-height: 40px;margin: 0 auto;background-color: #f8f4ce;text-align:center;color: #3f3f3f;font-size: 12px;"><div style="position: relative; width: 300px; margin: 0 auto;"><i class="icon-supbrowser" style="width: 14px; height: 14px; margin: 13px 0; background-image: url(http://t.static.delicloud.com/www/home/images/prompt.png?v=20180628); display: inline-block; position: absolute; left: 0; top: 0;"></i><p style="margin-left: 24px;text-align: left;">当前浏览器版本过低，推荐使用最新版<a href="https://ie.sogou.com/" target="_blank" style="color:#5d85e0;">搜狗高速浏览器</a></p></div></div>',s())),l({code:"0",msg:"成功",result:{code:"0",msg:"成功"}})):setTimeout(function(){d&&d({message:"参数错误",errorCode:"-1"})});break;case"app.onlogout":case"web.onlogout":l({code:"0",msg:"成功",result:{code:"0",msg:"成功"}});break;case"web.onrequest":m&&m.url&&m.user_id&&m.token?(h=(new Date).valueOf(),t.api({type:m.type,url:m.url,dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{},success:function(e){0==e.code&&l({code:"0",msg:"成功",result:{code:"0",data:e.data}})}})):setTimeout(function(){d&&d({message:"参数错误",errorCode:"-1"})});break;case"web.getNextInfo":m&&m.user_id&&m.dept_id&&m.token?(h=(new Date).valueOf(),f=0,g={user:[],organization:[]},t.api({type:"get",url:p+"/v1.0/org/department/"+m.dept_id+"/departments",dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{},success:function(e){0==e.code&&(f++,g.organization=e.data.result,2==f&&l({code:"0",msg:"成功",result:{code:"0",data:g}}))}}),t.api({type:"get",url:p+"/v1.0/org/department/"+m.dept_id+"/users",dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{},success:function(e){0==e.code&&(f++,g.user=e.data.result,2==f&&l({code:"0",msg:"成功",result:{code:"0",data:g}}))}})):setTimeout(function(){d&&d({message:"参数错误",errorCode:"-1"})});break;case"web.getCurrentInfo":m&&m.user_id&&m.org_id&&m.token?(h=(new Date).valueOf(),f=0,g={user:[],organization:[]},t.api({type:"get",url:p+"/v1.0/org/"+m.org_id+"/departments",dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{},success:function(e){0==e.code&&(f++,g.organization=e.data.result,2==f&&l({code:"0",msg:"成功",result:{code:"0",data:g}}))}}),t.api({type:"get",url:p+"/v1.0/org/top_department/"+m.org_id+"/users",dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{},success:function(e){0==e.code&&(f++,g.user=e.data.result,2==f&&l({code:"0",msg:"成功",result:{code:"0",data:g}}))}})):setTimeout(function(){d&&d({message:"参数错误",errorCode:"-1"})});break;case"web.getUsersFromOrg":m&&m.user_id&&m.dept_id&&m.token?(h=(new Date).valueOf(),t.api({type:"get",url:p+"/v1.0/org/"+m.dept_id+"/users",dauth:m.user_id+" "+h+" "+t.util.buildDauth(m.user_id,m.token,h),data:{query:m.text},success:function(e){0==e.code&&l({code:"0",msg:"成功",result:{code:"0",data:e.data}})}})):setTimeout(function(){d&&d({message:"参数错误",errorCode:"-1"})})}}(o,i,a,n)})}),e.deli=t,e.deliAsyncInit&&function(t){return t.__wrapper||(t.__wrapper=function(){try{return t.apply(this,arguments)}catch(i){return e.setTimeout(function(){throw i},0),!1}}),t.__wrapper}(e.deliAsyncInit)(),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return t})}(this);