!function(e){"use strict";var i,o,n,t,a,c,r,s=["backbutton"],l=["common.navigation.setTitle","common.navigation.setRight","common.navigation.close","common.image.upload","common.image.preview","common.image.save","common.file.upload","common.location.open","common.location.get","common.message.share","common.phone.vibrate","common.connection.getNetworkType","common.phone.getUUID","common.phone.getInterface","app.device.bind","app.user.telephoneCall","app.user.chatOpen","app.user.select","app.department.select","common.notification.showPreloader","common.notification.hidePreloader","common.notification.toast","app.organization.create","app.organization.select","app.config.init","app.method.transit","app.method.orgCreate","app.method.checkJsApis","app.session.get","app.user.get","app.organization.get","app.code.scan","common.navigation.hide","common.navigation.show","common.navigation.goBack","common.webview.close"],d=e.navigator.userAgent,p=d.match(/DeliAppv+[a-zA-Z0-9.-]+/);null===p&&(p=d.match(/DeliAppv+[a-zA-Z0-9.-]+/)),i=p,o=!1,n=null,t="app.method.checkJsApis",a=null,c={ios:/iPhone|iPad|iPod/i.test(d),android:/Android/i.test(d),version:i,isDeliApp:function(){return!!(this.version&&this.version.length>0)},type:function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},config:function(e){e&&(n={appId:e.appId||-1,timestamp:e.timestamp,noncestr:e.noncestr,sign:e.signature})},error:function(e){a=e},ready:function(i){var r=function(e){var r;if(!e)return console.log("bridge初始化失败");null!==n&&n.sign?c.ios?e.callHandler(t,n,function(o){var n=o||{},t=n.code,c=n.msg||"",r=n.data.result;0==t&&1==r?i(e):setTimeout(function(){a&&a({code:-1,msg:"权限校验失败 "+c})})}):c.android&&(r={path:"/app/premission/check/public",type:"get",params:n},e.callHandler(t,r,function(o){var n=JSON.parse(o)||{},t=n.code,c=n.msg||"",r=n.data.data.result;0==t&&1==r?i(e):setTimeout(function(){a&&a({code:-1,msg:"权限校验失败 "+c})})})):setTimeout(function(){a&&a({code:-1,msg:"权限校验失败 配置签名对象错误"})}),!1===o&&(o=!0,s.forEach(function(i){e.registerHandler(i,function(e,o){var n=document.createEvent("HTMLEvents");n.data=e,n.initEvent(i),document.dispatchEvent(n),o&&o({code:"0",msg:"成功"})})}),null===n&&encodeURIComponent(window.location.href))},l=function(e){if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none",i.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)};if(c.ios&&e.WebViewJavascriptBridge){try{WebViewJavascriptBridge.init(function(e,i){console.log("WebViewJavascriptBridge init: ",e,i)})}catch(d){console.log(d.msg)}return r(WebViewJavascriptBridge)}if(c.android&&e.WebViewJavascriptBridge){try{WebViewJavascriptBridge.init(function(e,i){console.log("WebViewJavascriptBridge init: ",e,i)})}catch(d){console.log(d.msg)}return r(WebViewJavascriptBridge)}if(c.ios)console.log("开始监听WebViewJavascriptBridgeReady事件"),l(function(e){!0,r(WebViewJavascriptBridge)});else{if(!c.android)return console.log("很抱歉，尚未支持您所持设备");console.log("开始监听WebViewJavascriptBridgeReady事件"),document.addEventListener("WebViewJavascriptBridgeReady",function(){if("undefined"==typeof WebViewJavascriptBridge)return console.log("WebViewJavascriptBridge 未定义");try{WebViewJavascriptBridge.init(function(e,i){})}catch(d){console.log(d.msg)}!0,r(WebViewJavascriptBridge)},!1)}}},r=function(e,i){var o,n,t=e.split("."),a=c;for(o=0,n=t.length;o<n;o++)o===n-1&&(a[t[o]]=i),"undefined"==typeof a[t[o]]&&(a[t[o]]={}),a=a[t[o]]},l.forEach(function(e){r(e,function(i,o,n){!function(e,i,o,n){var t,a,r,s,l,d,p;if("undefined"==typeof WebViewJavascriptBridge)return console.log("未定义WebViewJavascriptBridge");if(t=i||{},a=function(i){console.log("默认成功回调",e,i)},r=function(i){console.log("默认失败回调",e,i)},o&&(a=o),n&&(r=n),s=function(e){var i,o,n;console.log("统一响应：",e),c.ios?(o=(i=e||{}).code,n=JSON.parse(i.result).data,"0"===o?a&&a.call(null,n):r&&r.call(null,n,o)):c.android&&("string"==typeof e?(o=(i=JSON.parse(e)||{}).code,n=i.data):(o=(i=i=e||{}).code,n=i.data),"0"===o?a&&a.call(null,n):r&&r.call(null,n,o))},l=!0,c.android)switch(e){case"common.image.preview":for(d=[],p=0;p<t.urls.length;p++)d.push("http"==t.urls[p].split("://")[0]?t.urls[p]:t.urls[p].split(",")[1]?t.urls[p].split(",")[1]:t.urls[p]);t.urls=d}c.android?l?(WebViewJavascriptBridge.registerHandler(e,function(e,i){s({code:"0",msg:"成功",result:e}),i&&i({code:"0",msg:"成功"})}),WebViewJavascriptBridge.callHandler(e,t,s)):WebViewJavascriptBridge.callHandler(e,t,s):c.ios&&(l?(WebViewJavascriptBridge.registerHandler(e,function(e,i){s({code:"0",msg:"成功",result:e}),i&&i({code:"0",msg:"成功"})}),WebViewJavascriptBridge.callHandler(e,t,s)):WebViewJavascriptBridge.callHandler(e,t,s))}(e,i,o,n)})}),e.deli=c,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=c:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return c})}(this);